# JavaScript sdk 常用问题解答 FAQ

首页：指我方开发的用来加载游戏的页面；
游戏页：指CP方提供的游戏地址。

## 问题一 ： 如何加载JavaScript sdk？

回答：

1. 首先提供一个sdk登录完成后拉起游戏的全局函数
```js
// CP方需要实现的函数，在登录完成后会调用
window.rgAsyncInit = function () {
  // 获取用户信息
  //var user = RG.CurUserInfo();
  // 游戏登录
  ..........
}
```
2. 将此代码添加到页面中，sdk地址组成为:域名+ '/jssdk' + sdk版本 + '/sdk.js',sdk的版本是需要从查询参数中获得。
```js
/** 加载jsssdk */
var src = 'https://sdk-test.changic.net.cn/jssdk/' + sdkVersion + '/sdk.js';
(function (d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s);
  js.id = id;
  js.src = src
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'rg-jssdk'));
```
1. 测试sdk和正式sdk的区分，现有区分是根据查询参数：debugger来进行区分
  - 港台的游戏加载新加坡服务器域名
  - 越南加载越南服务器域名
  - 欧洲地区加载德国服务器域名
  - 测试的sdk加载测试服的域名

  至此加载完成。

##  问题二：RG.Install 的使用中的问题？
  1. 此方法只用于浏览器加载页面的情况下，主要用于存在微端包的情况下根据移动端浏览器的类型打开相应类型的商店下载微端包，若果没有微端包则根据浏览器类型判断来打开一个针对Safari或者chrome开发的引导页
  2. 在微端包中不需要加载到桌面的功能，可以根据RG.Install 这个方法的存在与否来做判断 ` if(RG.Install){} ` 

  3. 一般情况下pc端会有一个首页来使用iframe内嵌一个游戏页，首页上有添加到桌面的按钮，不需要此功能，因此应根据屏幕的宽度来做适配，按钮应在768px及以下的屏幕中显示，在>768px的显示器中不会加载这个功能，隐藏这个图标

## 问题三：RG.Mark 打点方法存在的意义？

  1. 打点是主要的投放的优化的方法，充值的点位需要提供金额和货币类型的参数，这个点位需要存在，根据支付的情况来优化投放的渠道，提高广告投放的效率降低广告的花费，因此尽可能的提供这一功能。
  2. 支付打点会有当服务端没有通知支付成功时客户端断网的情况，但是此情况比较极端，只要支付的点位能提供投放的支持，就有必要打这个点位。

## 问题四：加载完sdk 调用 RG.Pay方法调不起支付的问题？

  当没有配置任何商品时，调用支付只会在控制台中有日志，不会调起支付界面，因此当不能调起支付时，请提供测试商品表，或者提供测试商品表  

## 问题五：微端包的加载的链接是？

  在浏览器中我们会优先使用我们自己的首页来内嵌游戏页，但是微端包中由于过审等因素，需要直接加载游戏页地址。

## 问题六：上线的流程，和线上更新的流程？

  1. 当还没有上线时，同步正式服和测试服，优先使用正式服测试，测试完成直接上线。
  2. 上线后，在测试服测试没有问题，更新到正式服。  

## 问题七：游戏方（CP）需要提供的地址？

 1. 正式游戏地址
 2. 测试的游戏地址
 3. 如有侵权素材，需要提供一个用于提审的非侵权的提审的地址

## 问题八：切换帐户方法RG.ChangeAccount 的作用？
 
  在切换账号的过程中，会刷新整个页面，但在刷新前等待await RG.ChangeAccount的完成，可以在这个方法中来做一些在刷新之前要做的事情；如果没有需要执行的代码，不需要实现此函数，此函数默认是一个已决的promise。
